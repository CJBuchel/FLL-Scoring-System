parameters:
- name: target
  type: string

steps:
  # Build the flutter app
  - task: FlutterBuild@0
    inputs:
      target: ${{parameters.target}}
      projectDirectory: './tms'
      extraArgs: '--release'

  - task: ArchiveFiles@2
    inputs:
      rootFolderOrFile: './tms/build/${{parameters.target}}'
      archiveType: 'zip'
      archiveFile: '$(Build.ArtifactStagingDirectory)/client/tms-${{parameters.target}}-client.zip'

  - task: PublishBuildArtifacts@1
    inputs:
      pathToPublish: $(Build.ArtifactStagingDirectory)/client
      artifactName: '${{parameters.target}}-client'
