parameters:
- name: target
  type: string

steps:
  - template: pre-steps.yml
  - task: ArchiveFiles@2
    inputs:
      rootFolderOrFile: './server/target/release/*'
      archiveType: 'zip'
      archiveFile: '$(Build.ArtifactStagingDirectory)/server/${{parameters.target}}-server.zip'

  - task: PublishBuildArtifacts@1
    inputs:
      pathToPublish: $(Build.ArtifactStagingDirectory)/server
      artifactName: '${{parameters.target}}-server'
